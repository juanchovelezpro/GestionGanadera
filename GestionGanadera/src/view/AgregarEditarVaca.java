package view;

import java.awt.BorderLayout;
import java.awt.Font;
import java.awt.GridLayout;

import javax.swing.DefaultComboBoxModel;
import javax.swing.JButton;
import javax.swing.JComboBox;
import javax.swing.JDialog;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;
import javax.swing.JTextField;
import javax.swing.ScrollPaneConstants;
import javax.swing.SwingConstants;

import db.ResCRUD;
import model.Res;

public class AgregarEditarVaca extends JDialog {

	private Res res;
	private JTextField txtColor;
	private JComboBox comboEmbarazada;
	private JComboBox comboGenero;
	private JButton btnGuardarCerrar;
	private JComboBox comboTipo;
	private JTextField txtNumero;
	private JTextArea txtObservaciones;
	private JTextField txtMadre;
	private JButton btnCrias;
	private JLabel lblTipo;
	private JButton btnFechaNacimiento;
	private JButton btnFechaEmbarazo;
	private JButton btnVerRegistroPeso;

	public AgregarEditarVaca(Res res) {

		this.res = res;

		if (res != null)
			setTitle("Editar Vaca/ ID: " + res.getResID());
		else
			setTitle("Agregar vaca");

		getContentPane().setLayout(new GridLayout(1, 2));
		setSize(500, 700);
		setLocationRelativeTo(null);
		setComponents();
		listeners();

		cargarInfoRes();
		setVisible(true);

	}

	public void setComponents() {

		JPanel infoPanel = new JPanel();
		getContentPane().add(infoPanel);
		infoPanel.setLayout(new BorderLayout(0, 0));

		JLabel lblNewLabel = new JLabel("Informaci\u00F3n");
		lblNewLabel.setFont(new Font("Tahoma", Font.BOLD, 24));
		lblNewLabel.setHorizontalAlignment(SwingConstants.CENTER);
		infoPanel.add(lblNewLabel, BorderLayout.NORTH);

		JPanel panelBotones = new JPanel();
		infoPanel.add(panelBotones, BorderLayout.SOUTH);
		panelBotones.setLayout(new GridLayout(1, 0, 0, 0));

		btnGuardarCerrar = new JButton("Guardar y cerrar");
		panelBotones.add(btnGuardarCerrar);

		JPanel panelGeneralInfo = new JPanel();
		infoPanel.add(panelGeneralInfo, BorderLayout.CENTER);
		panelGeneralInfo.setLayout(new GridLayout(2, 1));

		JPanel panelAux = new JPanel();
		panelAux.setLayout(new GridLayout(10, 2));

		JLabel lblNumero = new JLabel("Numero");
		lblNumero.setFont(new Font("Tahoma", Font.BOLD, 12));
		lblNumero.setHorizontalAlignment(SwingConstants.CENTER);
		panelAux.add(lblNumero);

		txtNumero = new JTextField("");
		txtNumero.setHorizontalAlignment(SwingConstants.CENTER);
		panelAux.add(txtNumero);

		JLabel lblGenero = new JLabel("G\u00E9nero");
		lblGenero.setFont(new Font("Tahoma", Font.BOLD, 12));
		lblGenero.setHorizontalAlignment(SwingConstants.CENTER);
		panelAux.add(lblGenero);

		comboGenero = new JComboBox();
		comboGenero.setModel(new DefaultComboBoxModel(new String[] { "Seleccione el g\u00E9nero", "HEMBRA", "MACHO" }));
		panelAux.add(comboGenero);

		lblTipo = new JLabel("Tipo");
		lblTipo.setHorizontalAlignment(SwingConstants.CENTER);
		lblTipo.setFont(new Font("Tahoma", Font.BOLD, 12));
		panelAux.add(lblTipo);

		comboTipo = new JComboBox();
		comboTipo.setModel(new DefaultComboBoxModel(
				new String[] { "Seleccione el tipo", "VP", "VH", "CH", "HL", "NV", "CM", "ML", "MC", "TP" }));
		panelAux.add(comboTipo);

		JLabel lblColor = new JLabel("Color");
		lblColor.setFont(new Font("Tahoma", Font.BOLD, 12));
		lblColor.setHorizontalAlignment(SwingConstants.CENTER);
		panelAux.add(lblColor);

		txtColor = new JTextField("");
		txtColor.setHorizontalAlignment(SwingConstants.CENTER);
		panelAux.add(txtColor);

		JLabel lblFechaNacimiento = new JLabel("Fecha nacimiento");
		lblFechaNacimiento.setFont(new Font("Tahoma", Font.BOLD, 12));
		lblFechaNacimiento.setHorizontalAlignment(SwingConstants.CENTER);
		panelAux.add(lblFechaNacimiento);

		btnFechaNacimiento = new JButton("dd/mm/AAAA");
		btnFechaNacimiento.setFont(new Font("Tahoma", Font.BOLD, 12));
		panelAux.add(btnFechaNacimiento);

		JLabel lblEmbarazada = new JLabel("\u00BFEmbarazada?");
		lblEmbarazada.setFont(new Font("Tahoma", Font.BOLD, 12));
		lblEmbarazada.setHorizontalAlignment(SwingConstants.CENTER);
		panelAux.add(lblEmbarazada);

		comboEmbarazada = new JComboBox();
		comboEmbarazada.setModel(new DefaultComboBoxModel(new String[] { "NO APLICA", "NO", "SI" }));
		panelAux.add(comboEmbarazada);
		comboEmbarazada.setEnabled(false);

		JLabel lblFechaEmbarazo = new JLabel("Fecha embarazo");
		lblFechaEmbarazo.setFont(new Font("Tahoma", Font.BOLD, 12));
		lblFechaEmbarazo.setHorizontalAlignment(SwingConstants.CENTER);
		panelAux.add(lblFechaEmbarazo);

		panelGeneralInfo.add(panelAux);

		btnFechaEmbarazo = new JButton("dd/mm/AAAA");
		btnFechaEmbarazo.setFont(new Font("Tahoma", Font.BOLD, 12));
		btnFechaEmbarazo.setEnabled(false);
		panelAux.add(btnFechaEmbarazo);

		JLabel lblMadre = new JLabel("Madre");
		lblMadre.setFont(new Font("Tahoma", Font.BOLD, 12));
		lblMadre.setHorizontalAlignment(SwingConstants.CENTER);
		panelAux.add(lblMadre);

		txtMadre = new JTextField("");
		txtMadre.setHorizontalAlignment(SwingConstants.CENTER);
		panelAux.add(txtMadre);

		JLabel lblCrias = new JLabel("Crias");
		lblCrias.setFont(new Font("Tahoma", Font.BOLD, 12));
		lblCrias.setHorizontalAlignment(SwingConstants.CENTER);
		panelAux.add(lblCrias);

		btnCrias = new JButton("Ver Crias");
		btnCrias.setFont(new Font("Tahoma", Font.BOLD, 12));
		panelAux.add(btnCrias);

		JLabel lblRegistroPeso = new JLabel("Registro Peso");
		lblRegistroPeso.setHorizontalAlignment(SwingConstants.CENTER);
		lblRegistroPeso.setFont(new Font("Tahoma", Font.BOLD, 12));
		panelAux.add(lblRegistroPeso);

		btnVerRegistroPeso = new JButton("Ver Registro Peso");
		btnVerRegistroPeso.setFont(new Font("Tahoma", Font.BOLD, 12));
		panelAux.add(btnVerRegistroPeso);

		JPanel panelObservaciones = new JPanel();
		panelGeneralInfo.add(panelObservaciones);
		panelObservaciones.setLayout(new BorderLayout(0, 0));

		JPanel panel_7 = new JPanel();
		panelObservaciones.add(panel_7, BorderLayout.CENTER);
		panel_7.setLayout(new GridLayout(2, 1));

		JPanel lblNewLabel_15 = new JPanel();
		panel_7.add(lblNewLabel_15);
		lblNewLabel_15.setLayout(new GridLayout(5, 2));

		JLabel lblRegistroVacunas = new JLabel("Registro Vacunas");
		lblRegistroVacunas.setHorizontalAlignment(SwingConstants.CENTER);
		lblRegistroVacunas.setFont(new Font("Tahoma", Font.BOLD, 12));
		lblNewLabel_15.add(lblRegistroVacunas);

		JButton btnRegistroVacunas = new JButton("Ver Registro Vacunas");
		btnRegistroVacunas.setHorizontalAlignment(SwingConstants.CENTER);
		btnRegistroVacunas.setFont(new Font("Tahoma", Font.BOLD, 12));
		lblNewLabel_15.add(btnRegistroVacunas);

		JLabel lblRegistroPurgantes = new JLabel("Registro Purgantes");
		lblRegistroPurgantes.setHorizontalAlignment(SwingConstants.CENTER);
		lblRegistroPurgantes.setFont(new Font("Tahoma", Font.BOLD, 12));
		lblNewLabel_15.add(lblRegistroPurgantes);

		JButton btnRegistroPurgantes = new JButton("Ver Registro Purgantes");
		btnRegistroPurgantes.setHorizontalAlignment(SwingConstants.CENTER);
		btnRegistroPurgantes.setFont(new Font("Tahoma", Font.BOLD, 12));
		lblNewLabel_15.add(btnRegistroPurgantes);

		JLabel lblNewLabel_4 = new JLabel("");
		lblNewLabel_15.add(lblNewLabel_4);

		JLabel lblNewLabel_4_2 = new JLabel("");
		lblNewLabel_15.add(lblNewLabel_4_2);

		JLabel lblNewLabel_4_1 = new JLabel("");
		lblNewLabel_15.add(lblNewLabel_4_1);

		JLabel lblNewLabel_4_3 = new JLabel("");
		lblNewLabel_15.add(lblNewLabel_4_3);

		JLabel lblObservaciones = new JLabel("Observaciones");
		lblObservaciones.setHorizontalAlignment(SwingConstants.CENTER);
		lblObservaciones.setFont(new Font("SansSerif", Font.BOLD, 18));
		lblNewLabel_15.add(lblObservaciones);

		JLabel lblNewLabel_22_4 = new JLabel("");
		lblNewLabel_15.add(lblNewLabel_22_4);

		JScrollPane scrollPane = new JScrollPane();
		scrollPane.setHorizontalScrollBarPolicy(ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
		panel_7.add(scrollPane);

		txtObservaciones = new JTextArea();
		txtObservaciones.setLineWrap(true);
		scrollPane.setViewportView(txtObservaciones);

	}

	public void cargarInfoRes() {

		if (res != null) {

			txtNumero.setText(res.getResID());
			String genero = res.getGenero().equals("H") ? "HEMBRA" : "MACHO";
			comboGenero.setSelectedItem(genero);
			comboTipo.setSelectedItem(res.getTipo());
			txtColor.setText(res.getColor());

			if (res.getFecha_nacimiento() != null && !res.getFecha_nacimiento().equals(""))
				btnFechaNacimiento.setText(res.getFecha_nacimiento());
			else
				btnFechaNacimiento.setText("SIN REGISTRO");

			if (res.getGenero().equals("H")) {

				comboEmbarazada.setEnabled(true);
				btnFechaEmbarazo.setEnabled(true);

				String emb = res.getEmbarazada() == 0 ? "NO" : "SI";

				comboEmbarazada.setSelectedItem(emb);

				if (emb.equals("SI"))
					btnFechaEmbarazo.setText(res.getFecha_embarazo());

			} else {

				comboEmbarazada.setEnabled(false);
				btnFechaEmbarazo.setEnabled(false);

				comboEmbarazada.setSelectedItem("NO APLICA");

			}

			txtMadre.setText(res.getMadreID());
			txtObservaciones.setText(res.getObservaciones());

		}

	}

	public Res obtenerInfoRes() {

		Res res = new Res();

		res.setResID(txtNumero.getText());
		res.setTipo(comboTipo.getSelectedItem().toString());

		String genero = comboGenero.getSelectedItem().toString();

		if (genero.equals("HEMBRA")) {

			res.setGenero("H");

		} else {

			res.setGenero("M");

		}

		res.setColor(txtColor.getText());

		return res;

	}

	public void listeners() {

		btnFechaNacimiento.addActionListener(e -> {

			CalendarioDialog calendar = new CalendarioDialog(btnFechaNacimiento);

		});

		btnFechaEmbarazo.addActionListener(e -> {

			CalendarioDialog calendar = new CalendarioDialog(btnFechaEmbarazo);

		});

		btnCrias.addActionListener(e -> {

		});

		btnGuardarCerrar.addActionListener(e -> {

			// Guardar en la base de datos.

			if (res != null) {

			//	ResCRUD.update(res.getResID(), obtenerInfoRes());

			} else {

			//	ResCRUD.insert(obtenerInfoRes());

			}

			dispose();

		});

		comboGenero.addActionListener(e -> {

			String selected = comboGenero.getSelectedItem().toString();

			if (selected.equals("MACHO")) {

				comboEmbarazada.setSelectedItem("NO APLICA");
				comboEmbarazada.setEnabled(false);
				btnFechaEmbarazo.setText("NO APLICA");
				btnFechaEmbarazo.setEnabled(false);

			} else {

				comboEmbarazada.setEnabled(true);
				btnFechaEmbarazo.setEnabled(true);

			}

		});

	}

	public JTextField getTxtColor() {
		return txtColor;
	}

	public JComboBox getComboEmbarazada() {
		return comboEmbarazada;
	}

	public JComboBox getComboGenero() {
		return comboGenero;
	}

	public JButton getBtnGuardarCerrar() {
		return btnGuardarCerrar;
	}

	public JComboBox getComboTipo() {
		return comboTipo;
	}

	public JTextField getTxtNumero() {
		return txtNumero;
	}

	public JTextArea getTxtObservaciones() {
		return txtObservaciones;
	}

	public JTextField getTxtMadre() {
		return txtMadre;
	}

	public JButton getBtnCrias() {
		return btnCrias;
	}

	public JButton getBtnFechaNacimiento() {
		return btnFechaNacimiento;
	}

	public JButton getBtnFechaEmbarazo() {
		return btnFechaEmbarazo;
	}

	public JButton getBtnVerRegistroPeso() {
		return btnVerRegistroPeso;
	}
}
